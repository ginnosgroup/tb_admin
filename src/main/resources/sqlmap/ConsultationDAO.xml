<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="org.zhinanzhen.tb.dao.ConsultationDAO">
	<insert id="addConsultation" parameterType="org.zhinanzhen.tb.dao.pojo.ConsultationDO" useGeneratedKeys="true" keyProperty="id">
		insert into tb_consultation (gmt_create, gmt_modify, user_id, contents, remind_date, remind_contents)
		values (now(), now(), #{userId,jdbcType=INTEGER},
		  #{contents,jdbcType=VARCHAR}, #{remindDate,jdbcType=TIMESTAMP}, #{remindContents,jdbcType=VARCHAR})
	</insert>
	<select id="listConsultationByUserId" parameterType="java.lang.Integer" resultType="org.zhinanzhen.tb.dao.pojo.ConsultationDO">
        SELECT
            id,
            gmt_create AS gmtCreate,
            gmt_modify AS gmtModify,
            user_id AS userId,
            contents,
            remind_date AS remindDate,
            remind_contents AS remindContents
        FROM tb_consultation
        WHERE user_id = #{userId, jdbcType=INTEGER}
        ORDER BY gmt_create DESC;
    </select>
    <select id="listConsultationByRemindDate" parameterType="java.util.Date" resultType="org.zhinanzhen.tb.dao.pojo.ConsultationDO">
      <![CDATA[
        SELECT
            id,
            gmt_create AS gmtCreate,
            gmt_modify AS gmtModify,
            user_id AS userId,
            contents,
            remind_date AS remindDate,
            remind_contents AS remindContents
        FROM tb_consultation
        WHERE remind_date < #{date}
        ORDER BY gmt_create DESC;
      ]]>
    </select>
</mapper>